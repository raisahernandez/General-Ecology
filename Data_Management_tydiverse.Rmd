---
title: '<center>Intro II: Data management using tidyverse'
author: "<center>*Author: Raisa Hern√°ndez-Pacheco*"
output:
  html_document: default
  pdf_document: default
---

<style type="text/css">
.main-container {
  max-width: 800px;
}
pre code, pre, code {
  white-space: pre !important;
  overflow-x: scroll !important;
  word-break: keep-all !important;
  word-wrap: initial !important;
}
/* Whole document: */
body{
  font-family: helvetica;
  font-size: 12pt;
  text-align: justify;
}
code {white-space:pre !important; overflow-x:scroll !important;font-size:12pt; font-family:courier;}

  .col2 {
    columns: 2 200px;         /* number of columns and width in pixels*/
    -webkit-columns: 2 200px; /* chrome, safari */
    -moz-columns: 2 200px;    /* firefox */
  }

.col3 {
    columns: 3 200px;         /* number of columns and width in pixels*/
    -webkit-columns: 3 200px; /* chrome, safari */
    -moz-columns: 3 200px;    /* firefox */
  }
</style>

***

<br>

*This activity builds on [Part I: Intro to R and RStudio: data management and visualization](https://raisahernandez.github.io/General-Ecology/Import_data_to_R.html)*

<br>

Before any data analysis, there is an important step that you cannot avoid: data management. Through the process of data management you are able to re-arrange your dataset as needed. However, keep in mind there are generalizations on how to do good data management.    

<br>

**Student learning outcomes:**

  + Manage a data object by selecting and filtering columns; 
  + Manage date data. 
  
<br>

**References:**

  + [Data Carpentry](https://datacarpentry.org/R-ecology-lesson/03-dplyr.html)

<br>

**Materials:**

  + R and RStudio
  + Packages tidyverse
  + [Cayo_Santiago_female rhesus macaque data](https://doi.org/10.5061/dryad.p2c6r)

***
<br>

## 1. Managing data by selecting columns

Many functions like **str()** come built into R. However, R packages give you additional useful functions. You will be using some functions from the package *tidyverse* to manage your data (e.g., filtering columns, selecting columns). Before you use a package for the first time you need to install it in R. After installation, you should load it using **library()** in every subsequent R session as needed. 
```{r,eval=FALSE}
# installing tidyverse
install.packages("tidyverse",repos="http://cran.us.r-project.org")

# loading tidyverse
library(tidyverse)
```

<br>

Now, let's say we are interested only in the column "age_at_delivery" within "cayo" and we would like to create a new object named *delivery* with only that column. To select columns of a dataframe, we use the function **select()** in tidyverse. The first argument to this function is the data object, and the subsequent argument is the column to keep. 
```{r,eval=FALSE}
# selecting the column age_at_delivery
delivery <- select(cs,age_at_delivery)

# checking the new object created
delivery
```

<br>

**Question:**

a) *Is the new object in the Global Environment?* 

<br>

## 2. Managing data by filtering rows 
Now, say we are interested only in females with age at delivery equal to 17 years. To filter by row, we use the function **filter()** in tidyverse. The first argument in this function is the data object, and the subsequent arguments are the column name and the condition. **Note:** "==" means "identical to".
```{r,eval=FALSE}
# filtering females by age at delivery equal to 17
delivery17 <- filter(cayo,age_at_delivery==17)

# check the new dataframe created
delivery17
```

<br>

<span style='color:#2724ed; font-size:150%; font-weight:600'> Challenge 1: </span> Create a new object with the data of females with age at delivery higher than 17.

<br>

**Question:**

 a. *Is the new object in the Global Environment?* 
 b. *What happens if you also use the name "for"delivery17" for this new object?* 

<br>

## 3. Managing date data

We can also filter columns containing dates. When managing date data you should make sure to treat the variable as a date when coding. For this, we use the function **as.Date()**. Keep in mind that dates in numbers need to be written using "".
```{r,eval=FALSE}
# filtering females by the date of birth equal to May 08, 2011. 
may82011 <- filter(cs,as.Date(date_of_birth)==as.Date("2011-08-05"))

# check the new object created
may82011
```

<br>

<span style='color:#2724ed; font-size:150%; font-weight:600'> Challenge 2: </span>  Create a new object with the data of females being born after 2000-01-01.

<br>

<center>
**Great Work!**